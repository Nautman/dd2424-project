Linear(in_features=2048, out_features=1000, bias=True)
model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:1
training model with 1 unfrozen layers
Epoch 0/11
----------
phase: train
train Loss: 2.0987 Acc: 0.6242
phase: val
val Loss: 1.1218 Acc: 0.8791
epoch took: 23.41927742958069
Epoch 1/11
----------
phase: train
train Loss: 0.6639 Acc: 0.9181
phase: val
val Loss: 0.6329 Acc: 0.8995
epoch took: 22.37447452545166
Epoch 2/11
----------
phase: train
train Loss: 0.3796 Acc: 0.9507
phase: val
val Loss: 0.4946 Acc: 0.8954
epoch took: 20.64113998413086
Epoch 3/11
----------
phase: train
train Loss: 0.2555 Acc: 0.9736
phase: val
val Loss: 0.4203 Acc: 0.9049
epoch took: 23.02748990058899
Epoch 4/11
----------
phase: train
train Loss: 0.1854 Acc: 0.9748
phase: val
val Loss: 0.3727 Acc: 0.8995
epoch took: 20.709781885147095
Epoch 5/11
----------
phase: train
train Loss: 0.1498 Acc: 0.9884
phase: val
val Loss: 0.3666 Acc: 0.8981
epoch took: 20.669970989227295
Epoch 6/11
----------
phase: train
train Loss: 0.1201 Acc: 0.9918
phase: val
val Loss: 0.3337 Acc: 0.9130
epoch took: 23.356393575668335
Epoch 7/11
----------
phase: train
train Loss: 0.1063 Acc: 0.9903
phase: val
val Loss: 0.3223 Acc: 0.9062
epoch took: 20.809361934661865
Epoch 8/11
----------
phase: train
train Loss: 0.0845 Acc: 0.9969
phase: val
val Loss: 0.3075 Acc: 0.9158
epoch took: 22.87022638320923
Epoch 9/11
----------
phase: train
train Loss: 0.0719 Acc: 0.9977
phase: val
val Loss: 0.2987 Acc: 0.9144
epoch took: 21.082296133041382
Epoch 10/11
----------
phase: train
train Loss: 0.0637 Acc: 0.9965
phase: val
val Loss: 0.2939 Acc: 0.9076
epoch took: 20.63468885421753
Epoch 11/11
----------
phase: train
train Loss: 0.0569 Acc: 0.9984
phase: val
val Loss: 0.2869 Acc: 0.9158
epoch took: 21.315641164779663
Training complete in 4m 23s
Best val Acc: 0.915761
Linear(in_features=2048, out_features=1000, bias=True)
model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:2
training model with 2 unfrozen layers
Epoch 0/11
----------
phase: train
train Loss: 2.0838 Acc: 0.6165
phase: val
val Loss: 1.1213 Acc: 0.8573
epoch took: 22.82152533531189
Epoch 1/11
----------
phase: train
train Loss: 0.6564 Acc: 0.9224
phase: val
val Loss: 0.6329 Acc: 0.8981
epoch took: 22.709483861923218
Epoch 2/11
----------
phase: train
train Loss: 0.3716 Acc: 0.9554
phase: val
val Loss: 0.4970 Acc: 0.9049
epoch took: 23.361968994140625
Epoch 3/11
----------
phase: train
train Loss: 0.2521 Acc: 0.9701
phase: val
val Loss: 0.4173 Acc: 0.8995
epoch took: 20.73157286643982
Epoch 4/11
----------
phase: train
train Loss: 0.1927 Acc: 0.9790
phase: val
val Loss: 0.3822 Acc: 0.9144
epoch took: 22.590192556381226
Epoch 5/11
----------
phase: train
train Loss: 0.1509 Acc: 0.9872
phase: val
val Loss: 0.3555 Acc: 0.9171
epoch took: 23.226084232330322
Epoch 6/11
----------
phase: train
train Loss: 0.1227 Acc: 0.9903
phase: val
val Loss: 0.3247 Acc: 0.9117
epoch took: 20.702860116958618
Epoch 7/11
----------
phase: train
train Loss: 0.1061 Acc: 0.9946
phase: val
val Loss: 0.3109 Acc: 0.9144
epoch took: 21.26750349998474
Epoch 8/11
----------
phase: train
train Loss: 0.0873 Acc: 0.9953
phase: val
val Loss: 0.3028 Acc: 0.9185
epoch took: 22.57481861114502
Epoch 9/11
----------
phase: train
train Loss: 0.0766 Acc: 0.9957
phase: val
val Loss: 0.3016 Acc: 0.9117
epoch took: 20.733479499816895
Epoch 10/11
----------
phase: train
train Loss: 0.0630 Acc: 0.9984
phase: val
val Loss: 0.2962 Acc: 0.9035
epoch took: 21.250230073928833
Epoch 11/11
----------
phase: train
train Loss: 0.0569 Acc: 0.9981
phase: val
val Loss: 0.2814 Acc: 0.9117
epoch took: 20.908994436264038
Training complete in 4m 23s
Best val Acc: 0.918478
Linear(in_features=2048, out_features=1000, bias=True)
model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:3
training model with 3 unfrozen layers
Epoch 0/11
----------
phase: train
train Loss: 2.1218 Acc: 0.6029
phase: val
val Loss: 1.1227 Acc: 0.8777
epoch took: 22.223334550857544
Epoch 1/11
----------
phase: train
train Loss: 0.6707 Acc: 0.9220
phase: val
val Loss: 0.6692 Acc: 0.8845
epoch took: 22.972495317459106
Epoch 2/11
----------
phase: train
train Loss: 0.3760 Acc: 0.9523
phase: val
val Loss: 0.4860 Acc: 0.8967
epoch took: 22.859226942062378
Epoch 3/11
----------
phase: train
train Loss: 0.2576 Acc: 0.9693
phase: val
val Loss: 0.4168 Acc: 0.9130
epoch took: 22.839553356170654
Epoch 4/11
----------
phase: train
train Loss: 0.1986 Acc: 0.9783
phase: val
val Loss: 0.3734 Acc: 0.9022
epoch took: 20.81555199623108
Epoch 5/11
----------
phase: train
train Loss: 0.1477 Acc: 0.9876
phase: val
val Loss: 0.3473 Acc: 0.9090
epoch took: 20.624141931533813
Epoch 6/11
----------
phase: train
train Loss: 0.1195 Acc: 0.9942
phase: val
val Loss: 0.3341 Acc: 0.9022
epoch took: 21.2594792842865
Epoch 7/11
----------
phase: train
train Loss: 0.0995 Acc: 0.9950
phase: val
val Loss: 0.3146 Acc: 0.9144
epoch took: 22.556299209594727
Epoch 8/11
----------
phase: train
train Loss: 0.0900 Acc: 0.9930
phase: val
val Loss: 0.3139 Acc: 0.9130
epoch took: 20.566492319107056
Epoch 9/11
----------
phase: train
train Loss: 0.0744 Acc: 0.9984
phase: val
val Loss: 0.2808 Acc: 0.9158
epoch took: 23.059706449508667
Epoch 10/11
----------
phase: train
train Loss: 0.0625 Acc: 0.9992
phase: val
val Loss: 0.2958 Acc: 0.9090
epoch took: 20.62395930290222
Epoch 11/11
----------
phase: train
train Loss: 0.0595 Acc: 0.9969
phase: val
val Loss: 0.2814 Acc: 0.9158
epoch took: 20.784022331237793
Training complete in 4m 21s
Best val Acc: 0.915761
Linear(in_features=2048, out_features=1000, bias=True)
model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:4
training model with 4 unfrozen layers
Epoch 0/11
----------
phase: train
train Loss: 2.0921 Acc: 0.6304
phase: val
val Loss: 1.0930 Acc: 0.8682
epoch took: 22.900557279586792
Epoch 1/11
----------
phase: train
train Loss: 0.6526 Acc: 0.9196
phase: val
val Loss: 0.6393 Acc: 0.8872
epoch took: 22.412705421447754
Epoch 2/11
----------
phase: train
train Loss: 0.3758 Acc: 0.9491
phase: val
val Loss: 0.4800 Acc: 0.9049
epoch took: 22.667280673980713
Epoch 3/11
----------
phase: train
train Loss: 0.2594 Acc: 0.9682
phase: val
val Loss: 0.4157 Acc: 0.9117
epoch took: 22.263625144958496
Epoch 4/11
----------
phase: train
train Loss: 0.1895 Acc: 0.9821
phase: val
val Loss: 0.3658 Acc: 0.9076
epoch took: 20.482449769973755
Epoch 5/11
----------
phase: train
train Loss: 0.1529 Acc: 0.9849
phase: val
val Loss: 0.3503 Acc: 0.9090
epoch took: 21.429871082305908
Epoch 6/11
----------
phase: train
train Loss: 0.1200 Acc: 0.9926
phase: val
val Loss: 0.3364 Acc: 0.9117
epoch took: 20.640029907226562
Epoch 7/11
----------
phase: train
train Loss: 0.0978 Acc: 0.9953
phase: val
val Loss: 0.3156 Acc: 0.9171
epoch took: 22.1907696723938
Epoch 8/11
----------
phase: train
train Loss: 0.0862 Acc: 0.9942
phase: val
val Loss: 0.3081 Acc: 0.9076
epoch took: 21.21968960762024
Epoch 9/11
----------
phase: train
train Loss: 0.0772 Acc: 0.9946
phase: val
val Loss: 0.3015 Acc: 0.9090
epoch took: 20.72624111175537
Epoch 10/11
----------
phase: train
train Loss: 0.0684 Acc: 0.9957
phase: val
val Loss: 0.2893 Acc: 0.9117
epoch took: 20.50252079963684
Epoch 11/11
----------
phase: train
train Loss: 0.0555 Acc: 0.9984
phase: val
val Loss: 0.2841 Acc: 0.9103
epoch took: 21.150654554367065
Training complete in 4m 19s
Best val Acc: 0.917120
Linear(in_features=2048, out_features=1000, bias=True)
model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:5
training model with 5 unfrozen layers
Epoch 0/11
----------
phase: train
train Loss: 2.1120 Acc: 0.6122
phase: val
val Loss: 1.1036 Acc: 0.8872
epoch took: 22.49430561065674
Epoch 1/11
----------
phase: train
train Loss: 0.6713 Acc: 0.9247
phase: val
val Loss: 0.6522 Acc: 0.8859
epoch took: 20.738756895065308
Epoch 2/11
----------
phase: train
train Loss: 0.3641 Acc: 0.9612
phase: val
val Loss: 0.4932 Acc: 0.9008
epoch took: 22.675220489501953
Epoch 3/11
----------
phase: train
train Loss: 0.2499 Acc: 0.9736
phase: val
val Loss: 0.4071 Acc: 0.9076
epoch took: 22.58790612220764
Epoch 4/11
----------
phase: train
train Loss: 0.1872 Acc: 0.9837
phase: val
val Loss: 0.3786 Acc: 0.9022
epoch took: 21.239883184432983
Epoch 5/11
----------
phase: train
train Loss: 0.1518 Acc: 0.9837
phase: val
val Loss: 0.3609 Acc: 0.8940
epoch took: 20.519278526306152
Epoch 6/11
----------
phase: train
train Loss: 0.1242 Acc: 0.9907
phase: val
val Loss: 0.3486 Acc: 0.8981
epoch took: 20.618335247039795
Epoch 7/11
----------
phase: train
train Loss: 0.1042 Acc: 0.9918
phase: val
val Loss: 0.3193 Acc: 0.9090
epoch took: 22.89141821861267
Epoch 8/11
----------
phase: train
train Loss: 0.0877 Acc: 0.9953
phase: val
val Loss: 0.3022 Acc: 0.9158
epoch took: 22.387170553207397
Epoch 9/11
----------
phase: train
train Loss: 0.0766 Acc: 0.9984
phase: val
val Loss: 0.3039 Acc: 0.9117
epoch took: 20.5480899810791
Epoch 10/11
----------
phase: train
train Loss: 0.0653 Acc: 0.9981
phase: val
val Loss: 0.2946 Acc: 0.9212
epoch took: 22.914852380752563
Epoch 11/11
----------
phase: train
train Loss: 0.0564 Acc: 0.9977
phase: val
val Loss: 0.2902 Acc: 0.9158
epoch took: 20.933822870254517
Training complete in 4m 21s
Best val Acc: 0.921196
Accuracy for best config combination: tensor(0.9212, device='cuda:0')
Weights path for best combination ./model_name:resnet101;crop:False;random_flip:False;rotate_angle:0;random_resized_crop:False;device:cudaunfrozen:5.pt